<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NJIT ECET // SYSTEM ACCESS GRANTED</title>
    <!-- Load Tailwind CSS for utility styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use a hackery/terminal-friendly font -->
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for the terminal aesthetic */
        :root {
            --green: #00ff00;
            --dark-green: #004400;
            --bg-color: #0d1a0d;
        }

        body {
            font-family: 'VT323', monospace;
            background-color: var(--bg-color);
            color: var(--green);
            overflow: hidden; /* Prevent body scroll, canvas handles the screen */
        }
        
        /* The main terminal container */
        .terminal-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 1000px;
            height: 90vh;
            max-height: 700px;
            border: 2px solid var(--green);
            box-shadow: 0 0 10px var(--green), inset 0 0 10px var(--dark-green);
            background-color: rgba(0, 0, 0, 0.8);
            padding: 2rem;
            overflow-y: auto;
            z-index: 10;
        }

        /* Styling for text inside the terminal */
        .terminal-text {
            line-height: 1.5;
            text-shadow: 0 0 5px var(--green);
        }

        /* Input field styling */
        #command-input {
            color: var(--green);
            font-family: inherit;
            font-size: inherit;
            letter-spacing: 0.05em;
            caret-color: var(--green); /* Blinking caret/cursor */
        }

        /* Remove the default cursor element, let the input caret act as cursor */
        .cursor { display: none !important; }

        /* Canvas for the Matrix Rain Effect (Background) */
        #matrix-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            opacity: 0.2;
        }
        
        /* Utility overrides for hackery style */
        .terminal-text h1, .terminal-text h2 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: var(--green);
        }

        .terminal-text a {
            color: #00ffff; /* Cyan for links */
            text-decoration: none;
            transition: color 0.3s;
        }
        .terminal-text a:hover {
            color: #ff00ff; /* Magenta hover */
        }
        
        /* Scrollbar styling for a cleaner look */
        .terminal-container::-webkit-scrollbar {
            width: 8px;
        }
        .terminal-container::-webkit-scrollbar-thumb {
            background-color: var(--green);
            border-radius: 4px;
        }
        .terminal-container::-webkit-scrollbar-track {
            background: var(--dark-green);
        }

        @media (max-width: 640px) {
            .terminal-container {
                padding: 1rem;
                height: 95vh;
                max-height: none;
                width: 95%;
            }
            .terminal-text h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>

    <!-- Matrix Rain Background Canvas -->
    <canvas id="matrix-canvas"></canvas>

    <!-- Main Portfolio Terminal Window -->
    <div class="terminal-container">
        <div class="terminal-text text-sm md:text-base">
            <div id="output-history">
                <!-- Command output and previous prompts go here -->
            </div>
            
            <!-- Input line for user commands -->
            <form id="command-form" class="flex items-center mt-4">
                <span id="prompt-display">C:\></span>
                <input type="text" id="command-input" class="bg-transparent border-none p-0 ml-1 w-full" autofocus autocomplete="off">
            </form>
        </div>
    </div>

    <script>
        // Global Constants and Setup
        const FONT_SIZE = 12;
        const SPEED = 30; 

        // --- Hidden Feature Configuration ---
        // Change this link to your desired pirate or external website destination!
        const PIRATE_LINK = "https://fmhy.net/"; 

        // --- Firebase/Firestore Configuration (Placeholder) ---
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const apiKey = ""; 

        // --- Core Terminal State ---
        let CWD = '/'; // Current Working Directory
        let terminalMode = 'normal'; // Added state variable for interactive commands
        const outputHistory = document.getElementById('output-history');
        const promptDisplay = document.getElementById('prompt-display');
        const commandInput = document.getElementById('command-input');
        const commandForm = document.getElementById('command-form');

        // --- Portfolio File System Structure ---
        const fileSystem = {
            '/': {
                type: 'dir',
                contents: {
                    'profile.txt': 'user_profile',
                    'skills': 'dir_skills',
                    'projects': 'dir_projects',
                    'help.txt': 'help_info',
                    'readme.txt': 'readme_info',
                }
            },
            'dir_skills': {
                type: 'dir',
                contents: {
                    'programming_languages.txt': 'skills_programming_languages',
                    'modelling_gamedev.txt': 'skills_modelling_gamedev',
                    'ecet_hardware.txt': 'skills_ecet_hardware',
                    '../': '/', // Navigation link
                }
            },
            'dir_projects': {
                type: 'dir',
                contents: {
                    'non_profit_cloud.txt': 'proj_non_profit_cloud',
                    'art_design.txt': 'proj_art_design',
                    'set_construction.txt': 'proj_set_construction',
                    '../': '/', // Navigation link
                }
            }
        };

        // --- Portfolio Content Map (Actual text content) ---
        const contentMap = {
            'user_profile': [
                "<h2>[USER PROFILE]</h2>",
                "<p><strong>> NAME:</strong> VEDDHANG VENKATRAJAN</p>",
                "<p><strong>> MAJOR:</strong> Electrical and Computer Engineering Technology (ECET)</p>",
                "<p><strong>> UNIVERSITY:</strong> New Jersey Institute of Technology (NJIT)</p>",
                "<p><strong>> YEAR:</strong> Freshman (Fall 2025)</p>",
                "<p><strong>> CONTACT:</strong> <a href='mailto:your.email@njit.edu'>your.email@njit.edu</a> | GITHUB: <a href='#' target='_blank'>/veddhangv</a></p>",
            ],
            'help_info': [
                "<h2>[COMMAND LIST]</h2>",
                "<p><strong>ls</strong>: List contents of the current directory.</p>",
                "<p><strong>cd [directory]</strong>: Change directory. Use 'cd ..' to go up.</p>",
                "<p><strong>cat [file]</strong>: Display contents of a file.</p>",
                "<p><strong>clear</strong>: Clear the terminal screen.</p>",
                "<p><strong>whoami</strong>: Display current user and path.</p>",
                "<p><strong>sysinfo</strong>: Display detailed system status.</p>",
            ],
            'readme_info': [
                "<h2>[SYSTEM INFO]</h2>",
                "<p>Welcome to the Veddhang Venkatrajan ECET Portfolio System (v1.2.0).</p>",
                "<p>This terminal simulates an internal system view of Veddhang's interdisciplinary skills and projects.</p>",
                "<p>Last updated: 2025-11-18_15:30:00</p>",
                "<p>Type 'cat help.txt' to begin your exploration.</p>",
            ],
            'skills_programming_languages': [
                "<h2>[PROGRAMMING LANGUAGES]</h2>",
                "<p><strong>Languages:</strong> C, C#, Java, JavaScript, Python</p>",
                "<p>Focus areas include object-oriented programming (OOP), scripting for automation, and foundational ECET programming principles.</p>",
            ],
            'skills_modelling_gamedev': [
                "<h2>[MODELLING & GAME DEVELOPMENT]</h2>",
                "<p><strong>Game Engines:</strong> Unity, Unreal Engine 4/5, Godot</p>",
                "<p><strong>Modelling Tools:</strong> Blender, Maya, Onshape</p>",
                "<p>Experience in creating 3D assets, scene assembly, and implementing game logic using C# (Unity) and Blueprints (UE4/5).</p>",
            ],
            'skills_ecet_hardware': [
                "<h2>[ECET & HARDWARE SKILLS]</h2>",
                "<p><strong>Microcontrollers:</strong> ESP32, Arduino</p>",
                "<p><strong>Advanced Concepts:</strong> Rudimentary knowledge of FPGAs (Field-Programmable Gate Arrays).</p>",
                "<p><strong>Fabrication:</strong> 3D Printing, Woodworking, Set Construction.</p>",
            ],
            'proj_non_profit_cloud': [
                "<h2>[PROJECT: NON-PROFIT CLOUD/DATABASE]</h2>",
                "<p>- **Role**: Cloud Programmer / Database Administrator.</p>",
                "<p>- **Summary**: Assisted a non-profit organization in establishing and maintaining a secure database system for operations management.</p>",
                "<p>- **Key Skills**: Database structure, cloud programming concepts, security implementation.</p>",
            ],
            'proj_art_design': [
                "<h2>[PROJECT: DIGITAL ART & DESIGN]</h2>",
                "<p>- **Focus**: Logo design, merchandise branding, and digital illustration.</p>",
                "<p>- **Summary**: Designed several logos and promotional graphics, demonstrating skills in visual communication and digital art tools.</p>",
            ],
            'proj_set_construction': [
                "<h2>[PROJECT: SET CONSTRUCTION / WOODWORKING]</h2>",
                "<p>- **Focus**: Practical, hands-on fabrication and assembly.</p>",
                "<p>- **Summary**: Applied skills in woodworking and set construction to build physical structures, demonstrating precision and mechanical aptitude.</p>",
            ]
        };

        // --- Utility Functions ---

        /** Appends a new line of output to the history div and ensures scroll-to-bottom. */
        function appendOutput(content) {
            const outputElement = document.createElement('p');
            outputElement.innerHTML = content.join('<br>') || content;
            outputHistory.appendChild(outputElement);
            // Scroll to the latest output
            outputHistory.scrollTop = outputHistory.scrollHeight;
        }

        /** Updates the displayed prompt based on the CWD. */
        function updatePrompt() {
            promptDisplay.textContent = `C:${CWD}>`;
        }
        
        /** Gets the current directory's contents object */
        function getCurrentDir() {
            if (CWD === '/') {
                return fileSystem['/'];
            }
            // Remove leading/trailing slashes and convert to lowercase for the key lookup
            const pathSegments = CWD.substring(1).split('/').filter(s => s.length > 0);
            
            // Should always be one segment deep, e.g., 'skills' or 'projects'
            if (pathSegments.length > 0) {
                const dirName = pathSegments[0];
                const dirKey = `dir_${dirName.toLowerCase()}`;
                
                // Return the specific directory object if it exists
                if (fileSystem[dirKey]) {
                    return fileSystem[dirKey];
                }
            }
            
            // Fallback to the root if the path is invalid or unresolvable
            return fileSystem['/'];
        }

        // --- Command Processor ---

        function processCommand(input) {
            const trimmedInput = input.trim();
            const lowerInput = trimmedInput.toLowerCase();
            const parts = lowerInput.split(/\s+/);
            const command = parts[0];
            const arg = parts[1] || '';
            let output = [];
            let error = null;
            
            // Add the executed command to history display
            outputHistory.innerHTML += `<p><span class="text-green-300">C:${CWD}></span> ${trimmedInput}</p>`;

            // --- INTERACTIVE MODE CHECK (AHOY) ---
            if (terminalMode === 'ahoy_prompt') {
                if (command === 'n') {
                    output.push('<span class="text-yellow-500">Pirate navigation aborted. Returning to command prompt.</span>');
                    terminalMode = 'normal';
                } else if (command === 'y') {
                    output.push('<span class="text-green-300">Ahoy, Captain! Setting course for adventure...</span>');
                    output.push(`\t<a href="${PIRATE_LINK}" target="_blank" class="text-cyan-400">PIRATE_NAV_EXE (CLICK TO SAIL)</a>`);
                    terminalMode = 'normal';
                } else if (command === 'clear') {
                    outputHistory.innerHTML = '';
                    // Do not reset mode on clear
                } else if (command === '') {
                    // Do nothing, just re-prompt implicitly
                } else {
                    error = `Invalid response: ${trimmedInput}. Please type 'Y' to sail or 'N' to return.`;
                }

                if (error) {
                    output.push(`<span class="text-red-500">${error}</span>`);
                }
                
                appendOutput(output);
                commandInput.value = '';
                commandInput.focus();
                return; // Exit processing
            }

            // --- NORMAL MODE COMMANDS ---

            const currentDir = getCurrentDir();
            const contents = currentDir.contents;


            switch (command) {
                case 'ls':
                    // List contents of the current directory
                    const list = Object.keys(contents).map(item => {
                        const target = contents[item];
                        // If the target is a string that starts with 'dir_', it's a directory
                        const isDir = typeof target === 'string' && target.startsWith('dir_');
                        
                        // Apply a color for directories
                        return isDir ? `<span class="text-yellow-400">${item}</span>` : item;
                    }).join('\t');
                    output.push(list);
                    break;

                case 'cd':
                    // Change directory
                    if (arg === '..') {
                        // Go up one level (only possible if not at root)
                        if (CWD !== '/') {
                            CWD = '/';
                            updatePrompt();
                        }
                    } else if (arg && contents[arg] && contents[arg].startsWith('dir_')) {
                        // Change to a subdirectory
                        CWD = `/${arg}/`;
                        updatePrompt();
                    } else if (arg === '') {
                        // cd without argument goes to root
                        CWD = '/';
                        updatePrompt();
                    }
                    else {
                        error = `cd: ${arg}: No such file or directory.`;
                    }
                    break;

                case 'cat':
                    // Display file contents
                    if (arg && contents[arg] && !contents[arg].startsWith('dir_')) {
                        const fileKey = contents[arg];
                        output = contentMap[fileKey];
                    } else if (arg) {
                         error = `cat: ${arg}: Is a directory or does not exist.`;
                    } else {
                         error = `cat: Missing operand. Usage: cat [file]`;
                    }
                    break;
                
                case 'clear':
                    outputHistory.innerHTML = '';
                    break;

                case 'whoami':
                    output.push('User: root');
                    output.push(`Current Path: C:${CWD}`);
                    break;
                
                case 'sysinfo': // New System Info Command
                    output.push('=========================================');
                    output.push('<span class="text-cyan-400">NJIT ECET PORTFOLIO SYSTEM STATUS</span>');
                    output.push('=========================================');
                    output.push(`> Current User: <span class="text-green-300">VEDDHANG_V</span>`);
                    output.push(`> Program:      ECET Freshman`);
                    output.push(`> CWD:          <span class="text-yellow-400">C:${CWD}</span>`);
                    output.push(`> Last Access:  ${new Date().toLocaleString()}`);
                    output.push('-----------------------------------------');
                    output.push(`> Database Link: ONLINE (Non-Profit Experience)`);
                    output.push(`> Fabrication Module: READY (3D Print/Woodwork)`);
                    break;

                case 'ahoy': // HIDDEN FUNCTION: Set mode to interactive prompt
                    output.push('<span class="text-yellow-400">Ahoooy! Do you wish to sail the high seas? (Y/N)</span>');
                    terminalMode = 'ahoy_prompt';
                    break;
                    
                case '':
                    // Empty command
                    break;

                default:
                    error = `bash: ${command}: command not found. Type 'cat help.txt' for commands.`;
                    break;
            }

            if (error) {
                output.push(`<span class="text-red-500">${error}</span>`);
            }
            
            appendOutput(output);
            
            // Ensure input field is focused for continuous typing
            commandInput.value = '';
            commandInput.focus();
        }

        // --- Event Listener ---
        
        // CRITICAL FIX: Ensures the input field is always focused when the user presses a key,
        // preventing the keyboard from "failing" if the input loses focus.
        document.body.addEventListener('keydown', () => {
            if (document.activeElement !== commandInput) {
                commandInput.focus();
            }
        });
        
        commandForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const input = commandInput.value;
            processCommand(input);
        });
        
        // --- Matrix Rain Effect (Unchanged) ---
        const canvas = document.getElementById('matrix-canvas');
        const ctx = canvas.getContext('2d');
        let width = canvas.width = window.innerWidth;
        let height = canvas.height = window.innerHeight;
        let columns = Math.floor(width / FONT_SIZE);
        let drops = [];
        for (let i = 0; i < columns; i++) {
            drops[i] = 1;
        }
        const characters = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+{}|:"<>?`~-=;[]/\\';

        const setupCanvas = () => {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            columns = Math.floor(width / FONT_SIZE);
            drops = [];
            for (let i = 0; i < columns; i++) {
                drops[i] = 1;
            }
        };
        window.addEventListener('resize', setupCanvas);

        function drawMatrix() {
            ctx.fillStyle = 'rgba(13, 26, 13, 0.05)'; 
            ctx.fillRect(0, 0, width, height);
            ctx.fillStyle = '#00ff00'; 
            ctx.font = `${FONT_SIZE}px monospace`;

            for (let i = 0; i < drops.length; i++) {
                const text = characters[Math.floor(Math.random() * characters.length)];
                const x = i * FONT_SIZE;
                const y = drops[i] * FONT_SIZE;
                ctx.fillText(text, x, y);

                if (y > height && Math.random() > 0.97) {
                    drops[i] = 0;
                }
                drops[i]++;
            }
            requestAnimationFrame(drawMatrix);
        }

        // --- Initial Boot Sequence ---
        window.onload = function() {
            setupCanvas();
            drawMatrix();
            updatePrompt();
            
            // Initial boot message output
            const bootMsg = 'NJIT_ECET_SYSTEM v1.2.0 - Boot Successful.';
            const welcomeMsg = 'ACCESS GRANTED. Type <span class="text-cyan-400">cat readme.txt</span> to begin.';
            
            // The following line is from the previous version and should be removed if it exists
            const staticLine = document.getElementById('output-line-0');
            if (staticLine) staticLine.remove();

            // Simulate boot sequence text output (not typing character by character, but line by line)
            appendOutput(['INITIATING SYSTEM... [OK]', '']);
            setTimeout(() => appendOutput(['<span class="text-green-300">STATUS: ONLINE (100%)</span>', bootMsg]), SPEED * 20);
            setTimeout(() => appendOutput([welcomeMsg, '']), SPEED * 60);
            
            // Initial focus to ensure typing works right away
            commandInput.focus();
        };

    </script>
</body>
</html>